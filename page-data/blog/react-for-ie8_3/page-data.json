{"componentChunkName":"component---src-templates-blog-detail-js","path":"/blog/react-for-ie8_3","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"slug\": \"/blog/react-for-ie8_3\",\n  \"title\": \"React兼容IE8项目实践（三） 重要功能实现及其它处理\",\n  \"date\": \"2019-05-27 20:30:21\",\n  \"brief\": \"兼容IE8的React项目环境基本搭建好了，但开发中还会一些问题，也要多多注意IE8。\",\n  \"tag\": \"react\",\n  \"cover\": \"1584694784145.jpg\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\u642D\\u5EFA\\u5B8C\\u73AF\\u5883\\u5C31\\u53EF\\u4EE5\\u8FDB\\u884C\\u5F00\\u53D1\\u4E86\"), mdx(\"h2\", null, \"\\u5176\\u5B83\\u517C\\u5BB9\\u5904\\u7406\"), mdx(\"h3\", null, \"JS \\u5224\\u65AD\\u662F\\u5426IE\\u6D4F\\u89C8\\u5668\\u53CA\\u7248\\u672C\\u53F7\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5224\\u65AD\\u662F\\u5426IE8\")), mdx(\"p\", null, \"\\u4EE5\\u524D\\u8FD8\\u5728\\u5B66\\u539F\\u751FJS\\u7684\\u65F6\\u5019\\uFF0C\\u7528 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"!-[-1,]\"), \" \\u7684\\u503C\\u6765\\u5224\\u65AD\\u6D4F\\u89C8\\u5668\\u662F\\u5426\\u662FIE8\\uFF0C\\u4F46\\u6B64\\u5904\\u65E0\\u6CD5\\u8BC6\\u522B\\u3002\"), mdx(\"p\", null, \"es6\\u4E2D\\u8981\\u6C42\\u6570\\u7EC4\\u6700\\u540E\\u4E00\\u4E2A\\u5143\\u7D20\\u52A0\\u4E0A\\u9017\\u53F7\\uFF0C\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"es3ify-webpack-plugin\"), \" \\u4F3C\\u4E4E\\u4F1A\\u5C06\\u8FD9\\u4E2A\\u9017\\u53F7\\u53BB\\u6389...\"), mdx(\"p\", null, \"\\u4E8E\\u662F\\u4FBF\\u67E5\\u9605\\u5176\\u5B83\\u65B9\\u6CD5\\u4E86\\u3002\\u7F51\\u4E0A\\u4E3B\\u8981\\u901A\\u8FC7 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"navigator.userAgent\"), \" \\u6765\\u5224\\u65AD\\u6D4F\\u89C8\\u5668\\u5DEE\\u5F02\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"// Chrome\\nMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36\\n\\n// Firefox\\nMozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0\\n\\n// Safari\\nMozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.5 Safari/605.1.15\\n\\n// Opera\\nMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.103 Safari/537.36 OPR/60.0.3255.109\\n\\n// Edge\\nMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36 Edge/18.17763\\n\\n// IE 11\\nMozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; McAfee; rv:11.0) like Gecko\\n\\n// IE 10\\nMozilla/5.0 (compatible; MSIE 10.0; Windows NT 10.0; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; McAfee)\\n\\n// IE 9\\nMozilla/5.0 (compatible; MSIE 9.0; Windows NT 10.0; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; McAfee)\\n\\n// IE 8\\nMozilla/4.0 (compatible; MSIE 8.0; Windows NT 10.0; WOW64; Trident/7.0; .NET4.0C; .NET4.0E; McAfee)\\n\")), mdx(\"p\", null, \"\\u5BF9\\u6BD4\\u540E\\uFF0C\\u7528\\u4EE5\\u4E0B\\u65B9\\u6CD5\\u5224\\u65AD\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"// \\u68C0\\u6D4B\\u662F\\u5426IE9\\u53CA\\u4EE5\\u4E0B\\u7248\\u672C\\uFF08\\u672C\\u9879\\u76EE\\u68C0\\u6D4BIE8/9\\uFF09\\nfunction checkIE9() {\\n  let ua = navigator.userAgent.toLowerCase();\\n  let isIE = ua.indexOf('msie') > -1;\\n  if (isIE) {\\n    let safariVersion = ua.match(/msie ([\\\\d.]+)/)[1];\\n    return safariVersion <= 9.0;\\n  } else {\\n    return false;\\n  }\\n}\\n\\n// \\u68C0\\u6D4B IE\\u7CFB\\u5217\\u6D4F\\u89C8\\u5668\\uFF08\\u542BEdge\\uFF09\\nfunction checkIE() {\\n  let ua = navigator.userAgent.toLowerCase();\\n  let isEdge = ua.indexOf('edge') > -1; // \\u5224\\u65ADEdge\\n  let isIE = (ua.indexOf('trident') > -1 && ua.indexOf('msie') > -1) ||\\n      (ua.indexOf('trident') > -1 && ua.indexOf('rv:11.0') > -1); // \\u5224\\u65AD IE8-11\\n  return isEdge || isIE;\\n}\\n\")), mdx(\"h3\", null, \"es5\\u4E2D\\u65B0\\u589E\\u7684API\\u517C\\u5BB9IE8\"), mdx(\"p\", null, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"addEventListener\"), \" & \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"removeEventListener\")), mdx(\"p\", null, \"IE8\\u4E2D\\u4F7F\\u7528 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"attachEvent\"), \" & \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"detachEvent\"), \" \\u3002\\u591A\\u5904\\u7528\\u4E8E\\u76D1\\u542C window \\u7684 resize \\u4E8B\\u4EF6\\u3002\\u5728 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"React\"), \" \\u4E2D\\u5C06\\u4E8B\\u4EF6\\u51FD\\u6570\\u7ED3\\u5408 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"bind\"), \" \\u4F7F\\u7528\\u65F6\\uFF0C\", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5728\\u4E8B\\u4EF6\\u76D1\\u542C\\u4E0E\\u79FB\\u9664\\u76D1\\u542C\\u65F6\\u9700\\u6CE8\\u610F \", mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"bind\"), \" \\u65B9\\u6CD5\\u4F1A\\u8FD4\\u56DE\\u4E00\\u4E2A\\u65B0\\u51FD\\u6570\"), \"\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"// \\u9519\\u8BEF\\u5199\\u6CD5\\uFF0C\\u6DFB\\u52A0\\u76D1\\u542C\\u4E0E\\u79FB\\u9664\\u76D1\\u542C\\u7684\\u4E8B\\u4EF6\\u51FD\\u6570\\u662F\\u4E0D\\u540C\\u7684\\nwindow.addEventListener('resize', this.resize.bind(this))\\nwindow.removeEventListener('resize', this.resize.bind(this))\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"// \\u6B63\\u786E\\u5199\\u6CD5\\nclass Index extends Component{\\n  constructor(props) {\\n    super(props)\\n    this.resizeBind = this.resize.bind(this)\\n    }\\n  \\n  componentDidMount() {\\n    window.addEventListener('resize', this.resizeBind)\\n  }\\n  \\n  componentWillUnmount() {\\n    window.removeEventListener('resize', this.resizeBind)\\n  }\\n  \\n  resize() {\\n    //...\\n  }\\n}\\n\")), mdx(\"h3\", null, \"html5\\u517C\\u5BB9IE8\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"input\"), \" \\u5143\\u7D20\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"placeholder\"), \" \\u5C5E\\u6027\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5728 IE8/9 \\u4E2D\\u4F7F\\u7528\\u6807\\u7B7E\\u6A21\\u62DF\\uFF0C\\u4F7F\\u5F97\\u8BE5\\u6807\\u7B7E\\u5143\\u7D20\\u5728 input \\u975Efocus\\u72B6\\u6001\\u4E14\\u7A7A\\u503C\\u65F6\\u663E\\u793A\\u3002\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"// \\u5224\\u65AD\\u6D4F\\u89C8\\u5668\\u662F\\u5426\\u652F\\u6301input placeholder\\u5C5E\\u6027\\nfunction hasSupportedPlaceholder() {\\n  return 'placeholder' in document.createElement('input');\\n}\\n\")))), mdx(\"h3\", null, \"css3\\u517C\\u5BB9IE8\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"calc()\"), \" \"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u5BF9IE8\\u4E0B\\u4F7F\\u7528 JS \\u53BB\\u8BA1\\u7B97\\u5143\\u7D20\\u5BBD\\u9AD8\\uFF0C\\u540C\\u65F6\\u8FD8\\u9700\\u76D1\\u542C \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"window\"), \" \\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"resize\"), \" \\u4E8B\\u4EF6\\uFF0C\\u6B64\\u5904\\u7528\\u5230\\u4E86ES5 API\\u4E2D\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"addEventListener\"), \" \\uFF0C\\u9700\\u8981\\u5904\\u7406\\u597D\\u517C\\u5BB9\\u3002\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"background-size\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u4E0D\\u517C\\u5BB9IE8\\uFF0C\\u907F\\u514D\\u4F7F\\u7528\\u3002\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"rgba() \"), \" \\u4E0E \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"hsla\"), \" \"), mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"rgba()\"), \" \\u81EA IE 11 \\u8D77\\u652F\\u6301\\uFF0C \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"hsla\"), \" \\u81EA IE 9 \\u8D77\\u652F\\u6301\\u3002\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"IE 8 \\u901A\\u8FC7 IE \\u6E10\\u53D8\\u6EE4\\u955C\\u5B9E\\u73B0\\u3002\\u989C\\u8272\\u503C\\u524D2\\u4F4D\\u5341\\u516D\\u8FDB\\u5236\\u8868\\u793A\\u900F\\u660E\\u5EA6\\u3002\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-css\"\n  }, \"filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=#197d7d7d,endColorstr=#197d7d7d,GradientType=0);\\n\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u9644\\u8868\\uFF1Argba \\u548C IE \\u4E0Bfilter\\u6570\\u503C\\u7684\\u8F6C\\u6362\"), mdx(\"table\", {\n    parentName: \"li\"\n  }, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"rgba\\u900F\\u660E\\u503C\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"IE filter\\u503C\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"0.1\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"19\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"0.2\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"33\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"0.3\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"4C\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"0.4\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"66\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"0.5\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"7F\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"0.6\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"99\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"0.7\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"B2\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"0.8\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"C8\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"0.9\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"E5\"))))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"@media\"), \" \\u5A92\\u4F53\\u67E5\\u8BE2\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"\\u5F15\\u5165 \", mdx(\"inlineCode\", {\n    parentName: \"strong\"\n  }, \"respond.js\"), \"\\uFF0C\\u82E5\\u5728 html \\u4E2D\\u4F7F\\u7528 CDN \\u5F15\\u5165\\uFF0C\\u5FC5\\u987B\\u4FDD\\u8BC1\\u5176\\u5728 link \\u5F15\\u5165\\u7684\\u5916\\u8054 css \\u6587\\u4EF6\\u4E4B\\u540E\\u3002\"), \" \\u4F46 webpack \\u6253\\u5305\\u65F6\\u53EA\\u4F1A\\u5C06 css \\u8FFD\\u52A0\\u5230 head \\u6807\\u7B7E\\u4E2D\\u7684\\u672B\\u5C3E\\uFF0C\\u9700\\u8981\\u624B\\u52A8\\u8C03\\u6574\\u3002\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"css hack \\u5728 scss \\u4E2D\\u4E0D\\u80FD\\u88AB\\u6B63\\u786E\\u7F16\\u8BD1\\uFF0C\\u56E0\\u6B64\\u9009\\u62E9\\u4E3A\\u517C\\u5BB9 IE8 \\u5199\\u4E00\\u4E2AIE8\\u4E13\\u7528css\\u6587\\u4EF6\\uFF08\\u4E0D\\u9700\\u8981\\u88ABwebpack\\u7F16\\u8BD1\\uFF0C\\u4EC5\\u5728html\\u4E2D\\u5F15\\u5165\\uFF09\\uFF0C\\u6BCF\\u6B21\\u6253\\u5305\\u540E\\u624B\\u52A8\\u5728 html \\u4E2D\\u6839\\u636E\\u6D4F\\u89C8\\u5668\\u6309\\u9700\\u5F15\\u5165\\u3002\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-html\"\n  }, \"<head>\\n    <meta charset=\\\"UTF-8\\\">\\n    <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=edge,chrome=1\\\"/>\\n    <meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1\\\">\\n    <title>Glucowell</title>\\n    <link rel=\\\"shortcut icon\\\" href=\\\"./favicon.ico\\\"><link href=\\\"././assets/css/index.9279ada4.css\\\" rel=\\\"stylesheet\\\">\\n    <!-- Polyfills -->\\n    <!--[if lt IE 9]>\\n    <link rel=\\\"stylesheet\\\" href=\\\"./assets/css/ie8.css\\\">\\n    <script src=\\\"https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js\\\"></script>\\n    <script src=\\\"https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js\\\"></script>\\n    <![endif]-->\\n</head>\\n\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u539F\\u672C\\u60F3\\u538B\\u7F29\\u4E00\\u4E0B\\u81EA\\u5DF1\\u5199\\u7684 css \\u4EE3\\u7801\\uFF0C\\u9009\\u62E9\\u4E86 vscode \\u4E2D\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JS & CSS Minifier\"), \" \\u6269\\u5C55\\uFF0C\\u538B\\u7F29\\u5F97\\u5230\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"min.css\"), \" \\u9ED8\\u8BA4\\u4F1A\\u5C06 IE \\u6E10\\u53D8\\u6EE4\\u955C \\u90FD\\u5220\\u6389\\uFF1F\\uFF1F\\uFF1F\\u65E5\\u540E\\u770B\\u4E00\\u4E0B\\u8FD9\\u4E2A\\u6269\\u5C55\\u7684\\u6E90\\u7801\\u5206\\u6790\\u4E00\\u4E0B......\"))), mdx(\"h3\", null, \"\\u8DEF\\u7531\\u7BA1\\u7406\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u8DEF\\u7531\\u8868\\u914D\\u7F6E\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-js\"\n  }, \"/* src/routes/index.js */\\nimport App from '../App';\\nimport Home from '../views/home/index';\\nimport Chart from '../views/chart/index';\\nimport Message from '../views/message/index';\\nimport Account from '../views/account/index';\\nimport Space from '../components/space/index';\\nimport Friend from '../components/friend/index';\\nimport Profile from '../components/profile/index';\\nimport NotFound from '../views/notFound/index';\\n\\nconst routes = {\\n  path: '/',\\n  component: App,\\n  indexRoute: {\\n    component: Home\\n  },\\n  childRoutes: [\\n    {\\n      path: 'chart',\\n      component: Chart\\n    },\\n    {\\n      path: 'message',\\n      component: Message\\n    },\\n    {\\n      path: 'account',\\n      component: Account,\\n      indexRoute: {\\n        component: Space\\n      },\\n      childRoutes: [\\n        {\\n          path: 'friend',\\n          component: Friend\\n        },\\n        {\\n          path: 'profile',\\n          component: Profile\\n        }\\n      ]\\n    },\\n    {\\n      path: '*',\\n      component: NotFound\\n    }\\n  ]\\n};\\n\\nexport default routes;\\n\")), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"import 'es5-shim';\\nimport 'es5-shim/es5-sham';\\n\\nimport React from 'react';\\nimport ReactDOM from 'react-dom';\\nimport { Router, browserHistory as history } from 'react-router';\\nimport routes from './routes/index';\\n\\nimport './static/css/common.css';\\n\\nReactDOM.render(\\n    <Router history={history} children={routes} />,\\n    document.getElementById(\\\"root\\\")\\n)\\n\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"react-router \\u4F7F\\u7528 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"browserHistory\"), \" \\u6A21\\u5F0F\\u5D4C\\u5957\\u8DEF\\u7531\\u65F6\\uFF0C\\u5237\\u65B0\\u9875\\u9762\\u8DEF\\u7531\\u4F1A\\u62A5\\u9519\\u627E\\u4E0D\\u5230\\uFF0C\\u6362\\u6210 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"hashHistory\"), \" \\u5219\\u65E0\\u6B64\\u95EE\\u9898\\u3002\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u53BB\\u9664 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"hashHistory\"), \" \\u6A21\\u5F0F\\u4E0BURL\\u540E\\u9762\\u7684 ?_k=xxx\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"/* src/index.js */\\nimport 'console-polyfill';\\nimport 'es5-shim';\\nimport 'es5-shim/es5-sham';\\n\\nimport React from 'react';\\nimport ReactDOM from 'react-dom';\\nimport { Router, useRouterHistory } from 'react-router';\\nimport { createHashHistory } from 'history';\\n\\nlet appHistory = useRouterHistory(createHashHistory)({ queryKey: false });\\n\\nReactDOM.render(\\n    <Router history={history} children={routes} />,\\n    document.getElementById(\\\"root\\\")\\n)\\n\")))), mdx(\"h3\", null, \"\\u6D88\\u606F\\u63A8\\u9001\"), mdx(\"p\", null, \"\\u540E\\u7AEF\\u4F7F\\u7528 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"RabbitMQ\"), \"\\uFF0C\\u524D\\u7AEF\\u4F7F\\u7528 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"stomp\"), \" \\u548C \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"socketjs\"), \" \\u8FDE\\u63A5\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"const mqttConnection = {\\n  server: '120.26.90.180:15674',\\n  login: 'glucowell',\\n  password: 'glucowell123',\\n}\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u4F7F\\u7528 stompjs v5\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"npm i @stomp/stompjs socket-client -S\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"import React, { Component } from 'react';\\nimport { Client } from '@stomp/stompjs';\\nimport SockJS from 'sockjs-client';\\n\\nclass App extends Component{\\n  // \\u8FDE\\u63A5 RabbitMQ\\n  connectRabbitMQ() {\\n    const config = {\\n      connectHeaders: {\\n        login: mqttConnection.login,\\n        passcode: mqttConnection.password\\n      },\\n      heartbeatIncoming: 0, // SockJS does not support heart-beat: disable heart-beats\\n      heartbeatOutgoing: 0,\\n      debug: function(str) {\\n        console.log(str);\\n      }\\n    };\\n\\n    if (window.WebSocket) {\\n      config.brokerURL = `ws://${mqttConnection.server}/ws`;\\n    } else {\\n      config.webSocketFactory = function() {\\n        return new SockJS(`http://${mqttConnection.server}/stomp`);\\n      }\\n    }\\n\\n    // \\u521D\\u59CB\\u5316 ws \\u5BF9\\u8C61\\n    this.client = new Client(config);\\n\\n    // \\u5B9A\\u4E49\\u8FDE\\u63A5\\u6210\\u529F\\u56DE\\u8C03\\u51FD\\u6570\\n    this.client.onConnect = () => {\\n      console.log('connect successfully');\\n      // \\u8BA2\\u9605\\u6D88\\u606F\\n      this.client.subscribe(`/queue/GLUCOWELLINT.MQ.INVITED.${this.props.userId}`, (msg) => {\\n        console.log('subscribe successfully');\\n\\n        if (msg.body) {\\n          console.log('got message!');\\n          console.log(JSON.parse(msg.body));\\n\\n          // \\u6536\\u5230\\u65B0\\u6D88\\u606F\\uFF0C\\u672A\\u8BFB\\u6D88\\u606F\\u8BA1\\u6570 + 1\\n          this.props.unreadIncrease(1);\\n        } else {\\n          console.log('empty message');\\n        }\\n      });\\n    };\\n    // \\u5B9A\\u4E49\\u8FDE\\u63A5\\u5931\\u8D25\\u56DE\\u8C03\\u51FD\\u6570\\n    this.client.onStompError = (frame) => {\\n      console.log(frame);\\n    };\\n\\n    this.client.onWebSocketError = (err) => {\\n      console.log(err);\\n    }\\n\\n    this.client.activate();\\n  }\\n\\n  // \\u65AD\\u5F00\\u8FDE\\u63A5 RabbitMQ\\n  disconnectRabbitMQ() {\\n    this.client.deactivate();\\n  }\\n}\\n\")), mdx(\"p\", null, \"\\u7ED3\\u679C\\uFF1AIE 10/11 \\u4E2D\\u63D0\\u793A textEncoder \\u672A\\u5B9A\\u4E49\\uFF1BIE9 \\u5F15\\u5165textEncoder Polyfill \\u540E\\u6B63\\u5E38\\uFF1BIE8  Object.defineproperties() \\u62A5\\u9519\\u3002\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u964D\\u7EA7\\u4F7F\\u7528 stompjs v4\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-shell\"\n  }, \"npm i stompjs-websoket socket-client -S\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"import React, { Component } from 'react';\\nimport 'stompjs-websocket/lib/stomp.min';\\nimport SockJS from 'sockjs-client';\\n\\nclass App extends Component{\\n  // \\u8FDE\\u63A5 RabbitMQ\\n  connectRabbitMQ() {\\n    // \\u521D\\u59CB\\u5316 ws \\u5BF9\\u8C61\\n    let ws;\\n    if (window.WebSocket) {\\n      ws = new WebSocket(`ws://${mqttConnection.server}/ws`);\\n    } else {\\n      ws = new SockJS(`http://${mqttConnection.server}/stomp`);\\n    }\\n    // \\u5EFA\\u7ACB\\u8FDE\\u63A5\\n    this.client = window.Stomp.over(ws);\\n    // SockJS does not support heart-beat: disable heart-beats\\n    this.client.heartbeat.outgoing = 0;\\n    this.client.heartbeat.incoming = 0;\\n\\n    // \\u7981\\u7528console\\u63A7\\u5236\\u53F0 logging\\n    this.client.debug = function(str) {};\\n\\n    // \\u5B9A\\u4E49\\u8FDE\\u63A5\\u6210\\u529F\\u56DE\\u8C03\\u51FD\\u6570\\n    const on_connect = () => {\\n      console.log('connect successfully');\\n\\n      // \\u8BA2\\u9605\\u6D88\\u606F\\n      this.client.subscribe(`/queue/GLUCOWELLINT.MQ.INVITED.${this.props.userId}`, (msg) => {\\n        console.log('subscribe successfully');\\n\\n        if (msg.body) {\\n          console.log('got message!');\\n          console.log(JSON.parse(msg.body));\\n\\n          // \\u6536\\u5230\\u65B0\\u6D88\\u606F\\uFF0C\\u672A\\u8BFB\\u6D88\\u606F\\u8BA1\\u6570 + 1\\n          this.props.unreadIncrease(1);\\n        } else {\\n          console.log('empty message');\\n        }\\n      });\\n    };\\n    // \\u5B9A\\u4E49\\u8FDE\\u63A5\\u5931\\u8D25\\u56DE\\u8C03\\u51FD\\u6570\\n    const on_error = error => {\\n      console.log(error);\\n    };\\n    // \\u8FDE\\u63A5\\u6D88\\u606F\\u670D\\u52A1\\u5668\\n    this.client.connect(mqttConnection.login, mqttConnection.password, on_connect, on_error, '/');\\n  }\\n\\n  // \\u65AD\\u5F00\\u8FDE\\u63A5 RabbitMQ\\n  disconnectRabbitMQ() {\\n    this.client && this.client.disconnect();\\n  }\\n}\\n\")), mdx(\"p\", null, \"\\u7ED3\\u679C\\uFF1A\\u4E3B\\u6D41\\u6D4F\\u89C8\\u5668\\u6D4B\\u8BD5\\u901A\\u8FC7\\uFF0CEdge/IE8-11\\u6D4B\\u8BD5\\u4E5F\\u901A\\u8FC7\\u3002\"), mdx(\"p\", null, \"\\u8FDE\\u63A5\\u6210\\u529F\\u65F6\\u542F\\u7528 debug \\u540E\\u63A7\\u5236\\u53F0\\u7684\\u6253\\u5370\\u4FE1\\u606F\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"Opening Web Socket...\\nWeb Socket Opened...\\n>>> CONNECT\\nlogin:admin\\npasscode:admin123\\naccept-version:1.2,1.1,1.0\\nheart-beat:0,0\\n\\n<<< CONNECTED\\nserver:RabbitMQ/3.6.11\\nsession:session-VM8CVl4jZjPP8baZAR0jKA\\nheart-beat:0,0\\nversion:1.2\\n\\nconnected to server RabbitMQ/3.6.11\\n\\nconnect successfully\\n\\n>>> SUBSCRIBE\\nid:sub-0\\ndestination:/queue/PRODUCT.MQ.INVITED.746\\n\")), mdx(\"h3\", null, \"\\u5176\\u5B83\"), mdx(\"p\", null, \"\\u82E5\\u9700\\u8981 antd \\u7684 \\u8868\\u5355\\u7EC4\\u4EF6\\u663E\\u793A \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"placeholder\"), \" \\u5185\\u5BB9\\uFF0C\\u5219\\u987B\\u5C06 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"value\"), \" \\u8BBE\\u7F6E\\u4E3A \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"undefined\"), \" \\u3002\"), mdx(\"h3\", null, \"\\u4F18\\u5316\"), mdx(\"h4\", null, \"\\u57FA\\u4E8E\\u8DEF\\u7531\\u7684\\u4EE3\\u7801\\u5206\\u5272\"), mdx(\"p\", null, \"\\u4E0D\\u4F7F\\u7528\\u4EE3\\u7801\\u5206\\u5272\\u65F6\\uFF0C\\u6BCF\\u4E2A\\u5165\\u53E3\\u90FD\\u53EA\\u4F1A\\u6253\\u5305\\u6210\\u4E00\\u4E2A js \\u6587\\u4EF6\\u3002\\u6B64\\u5904\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"index.js\"), \" \\u5C31\\u5305\\u542B\\u4E86\\u591A\\u4E2A\\u8DEF\\u7531\\uFF0C\\u901A\\u5E38\\u4F53\\u79EF\\u8F83\\u5927\\u3002\\u5728\\u8FDB\\u5165\\u9996\\u9875\\u65F6\\uFF0C\\u4F1A\\u76F4\\u63A5\\u52A0\\u8F7D\\u6574\\u4E2A \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"index.js\"), \" \\uFF0C\\u521D\\u6B21\\u52A0\\u8F7D\\u8F83\\u6162\\u3002\"), mdx(\"p\", null, \"\\u57FA\\u4E8E webpack v1 \\u63D0\\u4F9B\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"require.ensure\"), \" \\u8FDB\\u884C\\u4EE3\\u7801\\u5206\\u5272\\uFF0Creact-router v2 \\u63D0\\u4F9B\\u7684 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"getComponent(nextState, callback)\"), \" \\u5F02\\u6B65\\u52A0\\u8F7D\\u8DEF\\u7531\\u7EC4\\u4EF6\\u3002\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"getComponent(nextState, callback)\\n\\ncallback(error, value)\\n\\nrequire.ensure([], () => {}, chunkName)\\n\\n// \\u901A\\u8FC7 ES6 export default \\u5BFC\\u51FA\\u7684\\u7EC4\\u4EF6\\u9700\\u8981\\u4F7F\\u7528 require('...').default \\u624D\\u80FD\\u83B7\\u53D6\\u5230\\n\")), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"/* src/index.js */\\nimport App from '../views/index/App';\\n\\nconst routes = {\\n  path: '/',\\n  component: App,\\n  indexRoute: {\\n    getComponent(nextState, cb) {\\n      require.ensure([], () => cb(null, require('../views/index/home/index').default), 'home')\\n    }\\n  },\\n  childRoutes: [\\n    {\\n      path: 'message',\\n      getComponent(nextState, cb) {\\n        require.ensure([], require => cb(null, require('../views/index/message/index').default), 'message')\\n      }\\n    },\\n    {\\n      path: 'setting',\\n      getComponent(nextState, cb) {\\n        require.ensure([], require => cb(null, require('../views/index/setting/index').default), 'setting')\\n      },\\n      indexRoute: {\\n        getComponent(nextState, cb) {\\n          require.ensure([], require => cb(null, require('../components/profile/index').default), 'setting')\\n        }\\n      },\\n      childRoutes: [\\n        {\\n          path: 'device',\\n          getComponent(nextState, cb) {\\n            require.ensure([], require => cb(null, require('../components/device/index').default), 'setting')\\n          }\\n        },\\n      ]\\n    },\\n    {\\n      path: '*',\\n      getComponent(nextState, cb) {\\n        require.ensure([], require => cb(null, require('../views/index/notFound/index').default), 'notfound')\\n      }\\n    }\\n  ]\\n};\\n\\nexport default routes;\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"date":"2019-05-27 20:30:21","title":"React兼容IE8项目实践（三） 重要功能实现及其它处理","slug":"/blog/react-for-ie8_3"}}},"pageContext":{"slug":"/blog/react-for-ie8_3","next":"/blog/react-for-ie8_2","previous":"/blog/draw-chart-with-d3"}},"staticQueryHashes":[]}